> LAB-2 Setup

*Visual Image*

<img width="865" height="388" alt="image" src="https://github.com/user-attachments/assets/9249c170-5100-411b-973e-b0611f3f9a61" /><br>

Limpiamos contenedores anteriores
```
docker stop $(docker ps -aq) && docker rm $(docker ps -aq)
```
Creamos una nueva red
```
docker network create --driver=bridge network1 --subnet=10.10.0.0/24
```
Creamos el contenedor de (producción) para la red interna del laboratorio
```
docker run -dit --name PRO ubuntu && docker network connect network1 PRO
```
```
docker exec PRO bash -c "apt update && apt install -y iproute2 net-tools iputils-ping apache2 php nano python3 curl"
```
```
docker exec PRO bash -c "service apache2 start"
```
Creamos el contenedor de (pre-producción) para la red interna del laboratorio
```
docker run -dit --name PRE --network=network1 ubuntu
```
```
docker exec PRE bash -c "apt update && apt install -y iproute2 net-tools iputils-ping nano php python3 curl"
```
Creamos el contenedor de (atacante) del laboratorio
```
docker run -dit --name ATTACKER ubuntu
```
```
docker exec ATTACKER bash -c "apt update && apt install -y iproute2 net-tools iputils-ping nano php python3 curl"
```
Comprobamos el estado de los contenedores estén UP:

<img width="894" height="131" alt="image" src="https://github.com/user-attachments/assets/0eba2cab-e1c4-4f98-af90-dc4ec82a6433" /><br>

En el contenedor de producción borramos el index.html y creamos el archivo /var/www/html/utility2.php y /var/www/html/login.html
```
docker exec PRO bash -c "rm /var/www/html/index.html"
```
Activamos una directiva de apache2
```
docker exec PRO bash -c "sed -i 's/allow_url_include = Off/allow_url_include = On/g' /etc/php/$(ls /etc/php/)/apache2/php.ini"
```
```
docker exec PRO bash -c "service apache2 restart"
```
Comprobamos el funcionamiento del utility2.php y login.html

<img width="1360" height="431" alt="image" src="https://github.com/user-attachments/assets/baeeed7d-8dbb-4f37-a05a-018f2f6c4ca9" /><br>
<img width="1161" height="693" alt="image" src="https://github.com/user-attachments/assets/7700f0ea-30cb-4e65-97e2-2dbe322510be" /><br>

Creamos un recurso en el contenedor de pre-producción:
```
docker exec PRE bash -c "mkdir -p /var/pages/dev-test"
```
```
docker exec PRE bash -c "echo 'Este contenido no lo deberias poder ver porque no esta expuesto al exterior y corresponde a un servicio web alojado en un maquina de una red interna de la red' > /var/pages/dev-test/index.html"
```
Iniciamos un servidor http con python desde el contenedor de pre-producción:
```
cd /var/pages/dev-test
```
```
python3 -m http.server 4646
```

